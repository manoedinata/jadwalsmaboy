<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Jadwal PAS 2024</title>

    <!-- Bootstrap -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH"
      crossorigin="anonymous"
    />
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz"
      crossorigin="anonymous"
    ></script>

    <!-- Custom CSS -->
    <link rel="stylesheet" href="./style.css" />
  </head>
  <body class="font-averta">
    <nav
      class="navbar navbar-dark bg-blue-dark navbar-expand-lg bg-body-tertiary"
    >
      <div class="container">
        <a class="navbar-brand" href="./index.html">Jadwal Pelajaran</a>
        <button
          class="navbar-toggler"
          type="button"
          data-bs-toggle="collapse"
          data-bs-target="#navbarNavAltMarkup"
          aria-controls="navbarNavAltMarkup"
          aria-expanded="false"
          aria-label="Toggle navigation"
        >
          <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarNavAltMarkup">
          <div class="navbar-nav ms-auto">
            <a class="nav-link" aria-current="page" href="./index.html"
              >Pelajaran</a
            >
            <a class="nav-link" aria-current="page" href="./guru.html">Guru</a>
            <a class="nav-link" aria-current="page" href="./lokasi_guru.html"
              >Lokasi Guru</a
            >
            <a class="nav-link" aria-current="page" href="./doa.html">Doa</a>
            <a class="nav-link active" href="./ujian.html">Ujian PAS 2024</a>
            <a class="nav-link" aria-current="page" href="./donasi.html"
              >Donasi</a
            >
          </div>
        </div>
      </div>
    </nav>

    <div id="hero" class="bg-blue-dark text-white">
      <div class="px-4 py-5 text-center">
        <h1 class="display-4 fw-bold">/uji·an/</h1>
        <div class="col-lg-6 mx-auto">
          <p class="lead mb-4">
            Lihat jadwal <u>Penilaian Sumatif Semester Gasal</u> untuk kelas X
            dan XI.
          </p>
          <form action="" method="get">
            <div class="d-grid gap-2 d-sm-flex justify-content-sm-center">
              <select
                id="pilihKelas"
                name="kelas"
                class="form-select form-select-lg"
                aria-label="Pilih kelas"
              >
                <option value="" selected>Pilih kelas...</option>
                <option value="X">Kelas X</option>
                <optgroup label="Kelas XI">
                  <option value="XI-1 – XI-4">Kelas XI-1 sampai XI-4</option>
                  <option value="XI-5 – XI-6">Kelas XI-5 sampai XI-6</option>
                  <option value="XI-7 – XI-8">Kelas XI-7 sampai XI-8</option>
                  <option value="XI-9 – XI-10">Kelas XI-9 sampai XI-10</option>
                  <option value="XI-11 – XI-12">
                    Kelas XI-11 sampai XI-12
                  </option>
                </optgroup>
                <optgroup label="Kelas XII">
                  <option value="XII-1 – XII-8">
                    Kelas XII-1 hingga XII-8
                  </option>
                  <option value="XII-9 – XII-12">
                    Kelas XII-9 hingga XII-12
                  </option>
                </optgroup>
              </select>
            </div>
          </form>
        </div>
      </div>

      <svg
        id="wave"
        style="transform: rotate(0deg); transition: 0.3s"
        viewBox="0 0 1440 95"
        version="1.1"
        xmlns="http://www.w3.org/2000/svg"
      >
        <defs>
          <linearGradient id="sw-gradient-0" x1="0" x2="0" y1="1" y2="0">
            <stop stop-color="rgba(255, 255, 255, 1)" offset="0%"></stop>
            <stop stop-color="rgba(255, 255, 255, 1)" offset="100%"></stop>
          </linearGradient>
        </defs>
        <path
          style="transform: translate(0, 0px); opacity: 1"
          fill="url(#sw-gradient-0)"
          d="M0,0L80,10C160,20,320,40,480,40C640,40,800,20,960,18.3C1120,17,1280,33,1440,40C1600,47,1760,43,1920,50C2080,57,2240,73,2400,80C2560,87,2720,83,2880,70C3040,57,3200,33,3360,26.7C3520,20,3680,30,3840,33.3C4000,37,4160,33,4320,38.3C4480,43,4640,57,4800,51.7C4960,47,5120,23,5280,13.3C5440,3,5600,7,5760,15C5920,23,6080,37,6240,45C6400,53,6560,57,6720,51.7C6880,47,7040,33,7200,35C7360,37,7520,53,7680,65C7840,77,8000,83,8160,71.7C8320,60,8480,30,8640,26.7C8800,23,8960,47,9120,60C9280,73,9440,77,9600,65C9760,53,9920,27,10080,25C10240,23,10400,47,10560,61.7C10720,77,10880,83,11040,81.7C11200,80,11360,70,11440,65L11520,60L11520,100L11440,100C11360,100,11200,100,11040,100C10880,100,10720,100,10560,100C10400,100,10240,100,10080,100C9920,100,9760,100,9600,100C9440,100,9280,100,9120,100C8960,100,8800,100,8640,100C8480,100,8320,100,8160,100C8000,100,7840,100,7680,100C7520,100,7360,100,7200,100C7040,100,6880,100,6720,100C6560,100,6400,100,6240,100C6080,100,5920,100,5760,100C5600,100,5440,100,5280,100C5120,100,4960,100,4800,100C4640,100,4480,100,4320,100C4160,100,4000,100,3840,100C3680,100,3520,100,3360,100C3200,100,3040,100,2880,100C2720,100,2560,100,2400,100C2240,100,2080,100,1920,100C1760,100,1600,100,1440,100C1280,100,1120,100,960,100C800,100,640,100,480,100C320,100,160,100,80,100L0,100Z"
        ></path>
      </svg>
    </div>

    <div id="jadwal" style="display: none">
      <div class="container">
        <h2 id="kelasName" class="text-center mb-4"></h2>
        <div class="table-responsive">
          <table id="jadwalTable" class="table text-center">
            <thead class="table-dark">
              <tr>
                <th scope="col">Tanggal</th>
                <th scope="col">Jam Ke-</th>
                <th scope="col">Mata Pelajaran</th>
              </tr>
            </thead>
            <tbody
              id="tbodyTable"
              style="vertical-align: middle; text-align: center"
            >
              <tr>
                <td colspan="6">Mengambil data...</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
    </div>

    <footer>
      <div class="container">
        <footer class="py-3 my-4">
          <p class="text-center text-body-secondary">
            © 2024 Hendra Manudinata
          </p>
        </footer>
      </div>

      <!-- jQuery -->
      <script
        src="https://code.jquery.com/jquery-3.7.1.min.js"
        integrity="sha256-/JqT3SQfawRcv/BIHPThkBvs0OEvtFFmqPF/lYI/Cxo="
        crossorigin="anonymous"
      ></script>

      <script>
        // Helpers
        function getMaxLengthInArrays(listOfArray) {
          let max_length = 0;
          listOfArray.forEach((element) => {
            if (element.length > max_length) {
              max_length = element.length;
            }
          });

          return max_length;
        }
        function formatDate(dateStr) {
          // Split the input date string and create a Date object
          const [day, month, year] = dateStr
            .split("-")
            .map((part) => parseInt(part, 10)); // Remove the leading zero from a two-digit date
          const date = new Date(`${year}-${month}-${day}`);

          // Arrays for day and month names in Indonesian
          const days = [
            "Minggu",
            "Senin",
            "Selasa",
            "Rabu",
            "Kamis",
            "Jumat",
            "Sabtu",
          ];
          const months = [
            "Januari",
            "Februari",
            "Maret",
            "April",
            "Mei",
            "Juni",
            "Juli",
            "Agustus",
            "September",
            "Oktober",
            "November",
            "Desember",
          ];

          // Get the day of the week, day, month, and year
          const dayName = days[date.getDay()];
          const monthName = months[date.getMonth()];

          // Format the date string
          return `${dayName}, ${day} ${monthName} ${year}`;
        }
      </script>
      <script>
        function getJadwal(kelas) {
          if (!kelas) return;
          $.ajax({
            url: `ujian/${kelas}.json`,
            type: "GET",
            dataType: "json",
            success: function (dataPerHari, textStatus, jqXHR) {
              $("#tbodyTable").empty();

              dataPerHari.forEach((data) => {
                // Ambil panjang jadwal
                lengthJadwal = data["jadwal"].length;

                data["jadwal"].forEach((jadwal, index) => {
                  // Bangun elemen
                  let trPerHari = document.createElement("tr");

                  if (index == 0) {
                    // 1. Tanggal
                    let tdTanggal = document.createElement("td");
                    tdTanggal.rowSpan = lengthJadwal;
                    tdTanggal.textContent = formatDate(data["tanggal"]);
                    trPerHari.appendChild(tdTanggal);
                  }

                  // 2.1. Jam ke-
                  let tdJam = document.createElement("td");
                  tdJam.textContent = jadwal[0].join("-");
                  trPerHari.appendChild(tdJam);

                  // 2.2. Mapel
                  let tdJadwal = document.createElement("td");
                  tdJadwal.textContent = jadwal[1];
                  trPerHari.appendChild(tdJadwal);
                  $("#tbodyTable").append(trPerHari);
                });
              });

              $("#kelasName").text("Jadwal Ujian " + kelas);
              $("#jadwal").show();
            },
          });
        }
      </script>
      <script>
        $("#pilihKelas").on("change", function () {
          $("form").submit();
        });

        $(document).ready(() => {
          // Support URL parameter
          const urlParams = new URLSearchParams(window.location.search);
          var kelas = urlParams.get("kelas");

          if (urlParams.get("kelas")) {
            $("#pilihKelas").val(kelas);

            // Ambil jadwal
            getJadwal(kelas);
          }
        });
      </script>
    </footer>
  </body>
</html>
